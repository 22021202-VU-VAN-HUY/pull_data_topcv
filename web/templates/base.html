<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or 'Job Finder' }}</title>

    <!-- Tailwind CDN (giống form cũ) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- CSS chung -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/job_detail.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/auth.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
  </head>
  <body class="base-body">
    <!-- HEADER -->
    <header class="base-header">
      <div class="base-header-inner">
        <!-- Logo -->
        <a href="{{ url_for('jobs.index') }}" class="base-logo">
          <span class="base-logo-text">Job</span><span class="base-logo-highlight">Finder</span>
        </a>

        <!-- Search form (trang chủ sẽ dùng) -->
        <form action="{{ url_for('jobs.index') }}" method="get" class="base-search-form">
          <div class="base-search-row">
            <input
              name="q"
              value="{{ q or '' }}"
              placeholder="Tìm theo tiêu đề, công ty..."
              class="base-search-input"
            />
            <button
              class="base-button base-button-primary"
              type="submit"
            >
              Tìm kiếm
            </button>
          </div>
        </form>

        <!-- User menu -->
        <nav class="base-user-nav">
          <!-- Khi chưa đăng nhập -->
          <a href="{{ url_for('auth.login_page') }}" class="base-link" id="nav-login">
            Đăng nhập
          </a>
          <a href="{{ url_for('auth.register_page') }}" class="base-link" id="nav-register">
            Đăng ký
          </a>

          <!-- Khi đã đăng nhập -->
          <div class="base-user-menu hidden" id="nav-user-menu">
            <button
              type="button"
              class="base-user-button"
              id="nav-user-button"
            >
              <span id="nav-user-name">Tài khoản</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="base-user-icon" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                      d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.08z"
                      clip-rule="evenodd" />
              </svg>
            </button>
            <div
              id="nav-user-dropdown"
              class="base-user-dropdown hidden"
            >
              <a href="{{ url_for('auth.profile_section', section='bookmarks') }}" class="base-user-dropdown-link">
                Công việc đã lưu
              </a>
              <a href="{{ url_for('auth.profile_section', section='info') }}" class="base-user-dropdown-link">
                Thông tin người dùng
              </a>
              <a href="{{ url_for('auth.profile_section', section='password') }}" class="base-user-dropdown-link">
                Đổi mật khẩu
              </a>
              <div class="base-user-divider"></div>
              <button
                type="button"
                id="nav-logout"
                class="base-user-dropdown-button"
              >
                Đăng xuất
              </button>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <!-- MAIN -->
    <main class="base-main">
      {% block content %}{% endblock %}
    </main>

    <!-- CHATBOT -->
    <div id="chat-widget" class="chat-widget">
      <div id="chat-panel" class="chat-panel hidden">
        <div class="chat-header">
          <div>
            <p class="chat-header-title">Chatbot JobFinder</p>
            <p class="chat-header-sub">
              Chatbot hỗ trợ người dùng tìm công việc.
            </p>
          </div>
          <button
            id="chat-close"
            class="chat-close"
            type="button"
            aria-label="Đóng chat"
          >
            ✕
          </button>
        </div>

        <div id="chat-messages" class="chat-messages"></div>

        <div class="chat-status" id="chat-status"></div>

        <form id="chat-form" class="chat-form">
          <input
            id="chat-input"
            autocomplete="off"
            placeholder="Nhập câu hỏi về công việc, lương, kỹ năng..."
            class="chat-input"
          />
          <button
            id="chat-send"
            type="submit"
            class="chat-send"
          >
            Gửi
          </button>
        </form>
      </div>

      <button
        id="chat-toggle"
        type="button"
        class="chat-toggle"
        title="Mở chat"
      >
        Chat
      </button>
    </div>

    <footer class="base-footer">
      JobFinder by Huyvu
    </footer>

    <!-- JS -->
    <script src="{{ url_for('static', filename='js/api_client.js') }}"></script>
    <script src="{{ url_for('static', filename='js/layout.js') }}"></script>
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script src="{{ url_for('static', filename='js/profile.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chat_widget.js') }}"></script>
  </body>
</html>
